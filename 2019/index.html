<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="copyright" content="All content on www.nimblemachines.com is copyrighted. All rights are reserved." />
<meta name="keywords" content="journal, 2019, blog" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="/-/screen.css" type="text/css" />
<link rel="icon" href="/-/sierra_sky_150x150.jpg" type="image/jpeg" />
<link rel="canonical" href="https://www.nimblemachines.com/2019/" />
<title>2019 journal &ndash; Nimble Machines</title>
</head>
<body>

<div id="header">
<h1>2019 journal</h1>
<hr />
</div>

<div id="content">
<h3 id="september-25-13:49"><a href="#september-25-13:49">2019 September 25 13:49</a></h3>
<h4 id="github-vs-bitbucket"><a href="#github-vs-bitbucket">GitHub vs Bitbucket</a></h4>
<p>After learning that Bitbucket have <a href="https://bitbucket.org/blog/sunsetting-mercurial-support-in-bitbucket">announced that they are sunsetting Mercurial support</a>, I went through all my Bitbucket repos and converted the Mercurial ones to Git. Since GitHub now offers unlimited private repos in their free plan, I went ahead and pushed all my Bitbucket repos over to GitHub.</p>
<p>As a backup? I&rsquo;m not sure yet which platform I want to use as my primary storage for repos.</p>
<p>Bitbucket has serious UX problems. In the process of trying to find all my Mercurial repos, rename each one with a &ldquo;-hg&rdquo; suffix to make it obvious (since the UI also has no way of showing, in the list view, whether a repo is Git or Mercurial), and then convert them to Git, I discovered that the interfaces (yes, there is more than one) for viewing all your Bitbucket repos is very broken. There is no way to sort the list by name, which is exactly what I wanted because then &ldquo;repo&rdquo; and &ldquo;repo-hg&rdquo; would be next to each other, and I could more easily track my &ldquo;renaming and converting&rdquo; process.</p>
<p>The default (and only) sort is by &ldquo;last-modified&rdquo;! Since renaming a repo is considered a modification, just trying to rename my Mercurial repos wreaked havoc on the sort order. Really stupid.</p>
<p>In their announcement Bitbucket did <em>not</em> announce that they had created a handy tool to do a pushbutton, batch conversion of Mercurial repos to Git, instead simply <a href="https://bitbucket.org/blog/sunsetting-mercurial-support-in-bitbucket#How-to-migrate-and-export">pointing users to two open-source projects</a>: hg-fast-export and hg-git.</p>
<p>I had good luck using hg-fast-export. (The <a href="https://github.com/frej/fast-export">documentation for hg-fast-export</a> and the <a href="https://git-scm.com/book/en/v2/Git-and-Other-Systems-Migrating-to-Git#_mercurial">instructions in the online Git book</a> are both good.) To suggest the scale of the effort, I have thirty-something repos in my Bitbucket account. Because of the manual nature of the conversion process, and because the Bitbucket UX is so terrible, this process took several hours spread over two days.</p>
<p>Saddling users with big manual migrations because you no longer support your product is <em>not</em> a good PR move. Way to build trust with your users, Bitbucket!</p>
<p>Predictably, when the <a href="https://community.atlassian.com/t5/Bitbucket-articles/What-to-do-with-your-Mercurial-repos-when-Bitbucket-sunsets/ba-p/1155380">sunsetting was announced on the forum</a>, it lit up, with users saying things like:</p>
<blockquote><p> &ldquo;I initially thought this was an April fool&rsquo;s joke, then I realized it was August. The only reason we chose BitBucket over GitHub in the first place was because of the Mercurial support, so we really have no reason to stay with BitBucket if Mercurial is removed. A sad day indeed, but hey, the almighty buck wins out again over customer loyalty :(&rdquo;</p></blockquote>
<blockquote><p> &ldquo;Probably most Mercurial customers will either move their repos to another Mercurial site or else they convert the affected repositories to git and move to a provider with &ndash; let&rsquo;s hope so &ndash; more long term service continuity.&rdquo;</p></blockquote>
<blockquote><p> &ldquo;If there is no automated script to make the transition, I&rsquo;m afraid all my repos will migrate to GitHub.&rdquo;</p></blockquote>
<p>The announcement also suggested, to users who want to stick with Mercurial, that there are other vendors still hosting Mercurial repos. But why would they stay in business if the biggest player is exiting the market (because of shrinking market- and mind-share for Mercurial)? Sadly, it doesn&rsquo;t look good for the future of Mercurial generally.</p>
<p>If you have the stomach for such things, you can <a href="https://news.ycombinator.com/item?id=20745393">read the comments on Hacker News</a> about this announcement. Fortunately, just to keep things lively, at least one person mentioned <a href="https://fossil-scm.org/home/doc/trunk/www/index.wiki">Fossil</a>! (You should go read about Fossil. It&rsquo;s an interesting project, brought to you by the same folks that make SQLite.)</p>
<p>I&rsquo;m wondering if this isn&rsquo;t the beginning of the end for Bitbucket. They were founded as &ldquo;GitHub for Mercurial users&rdquo;. Then they added Git. Then they discovered that their users create 100 Git repos for every Mercurial repo. Citing cost reasons &ndash; it takes signficant engineering resources to support both VCSs &ndash; they are sunsetting Mercurial.</p>
<p>But then, why use Bitbucket? The community on GitHub is four times larger.</p>
<p>According to the <a href="https://github.com/home">GitHub homepage</a>, as of August 2019 it had 40M users and 100M repos. <a href="https://bitbucket.org/product/">Bitbucket homepage</a> doesn&rsquo;t mention repo count but says &ldquo;more than 10M developers&rdquo; use Bitbucket.</p>
<p>For now I&rsquo;m keeping my account on Bitbucket as a backup, but their fortunes could change quickly.</p>
<hr />
<h3 id="september-25-01:19"><a href="#september-25-01:19">2019 September 25 01:19</a></h3>
<p>A quick update to the previous post. After suffering from disk thrashing and terrible performance &ndash; lots of spinning beach balls &ndash; I decided to re-install High Sierra but onto an HFS+ partition (case-sensitive of course!) rather than APFS. I almost decided to install El Capitan instead but thought it was worth giving High Sierra another try.</p>
<p>It&rsquo;s been night and day so far, compared to the APFS install. The machine is snappy and works well.</p>
<p>My advice is: Don&rsquo;t install APFS on spinning disks! Ever!</p>
<hr />
<h3 id="march-20-00:48"><a href="#march-20-00:48">2019 March 20 00:48</a></h3>
<p>I just upgraded a mid-2011 iMac (iMac12,1 for you Apple nerds) to High Sierra. I thought I would wait until all the bugs were ironed out. Hah. That worked out really well. ;-)</p>
<p>I&rsquo;m not here to talk about bugs in the software, but about bugs in the &ldquo;documentation&rdquo;. In particular about APFS (the new Apple File System) and its vaunted encryption feature. There is no &ndash; or contradictory &ndash; information available about how to use it, and, in particular, how to do a clean install onto an APFS encrypted disk.</p>
<p>&ldquo;Help&rdquo; on the machine itself is notoriously useless. But finding authoritative information about APFS from Apple &ndash; through <em>any</em> channel &ndash; is nearly impossible.</p>
<p>I did find <a href="https://www.reddit.com/r/mac/comments/7np7n2/apfs_or_apfs_encrypted/">a post on Reddit</a> that claimed that FileVault and APFS encryption were the same thing, and also claimed that Apple suggests that in order to achieve an encrypted APFS install, that we install to an <em>un-encrypted</em> disk and turn on FileVault after the fact. This didn&rsquo;t sound right.</p>
<p>People are talking about this, and everyone is confused:</p>
<ul>
<li><a href="https://www.reddit.com/r/apple/comments/72hcyl/is_apfs_encrypted_and_filevault_on_the_same/">Is APFS (Encrypted) and FileVault on the same volume redundant?</a></li>
<li><a href="https://www.reddit.com/r/osx/comments/9mhn5g/apple_apfs_encryption_question/">Apple APFS Encryption Question</a></li>
<li><a href="https://www.reddit.com/r/apple/comments/72oz8m/understanding_the_difference_between_apfs/">Understanding the difference between APFS encryption and FileVault</a></li>
</ul>
<p>Then I found <a href="https://discussions.apple.com/thread/8085938">this post on discussions.apple.com</a> which seemed to highlight everything that was bothering me about the APFS encryption story &ndash; especially the confusing <code>System&nbsp;Preferences&nbsp;&gt;&gt;&nbsp;Security&nbsp;&amp;&nbsp;Privacy</code> UI about turning on FileVault. What does this do? Is it the same thing as somehow turning on APFS encryption using Disk Utility or the <code>diskutil&nbsp;apfs</code> command? Who knows!</p>
<p>This <a href="https://support.apple.com/en-us/HT202385">support topic about institutional recovery keys</a> sheds some light on the subject. It suggests that Apple wants us to think that &ldquo;FileVault&rdquo; and &ldquo;encrypted disk&rdquo; are basically the same thing &ndash; even though the mechanisms for achieving that encryption are different among CoreStorage, HFS+, and APFS. Conflating related but distinct notions usually leads to people having an erroneous (aka false) mental model of a system, and this often leads to frustration or worse &ndash; maybe even to catastrophic data loss. This isn&rsquo;t a good place to cut corners on clarity.</p>
<p>Reading the <code>diskutil</code> man page can be an exercise in frustration as well. There is some discussion of &ldquo;crypto users&rdquo; and &ldquo;crypto keys&rdquo; but no good definitions of these. Also, what does <code>-role</code> do? What do the B, R, and V flags mean? There is no explanation.</p>
<p>Is APFS ready for production use on spinning disks? I installed it on the iMac&rsquo;s 2011-vintage 500GB Seagate drive. (It even has 512 byte sectors! How totally pass&eacute;!) Was this a mistake? The machine isn&rsquo;t sluggish exactly, but it&rsquo;s not screaming along either. Is APFS slowing it down? Or just the fact that it&rsquo;s memory-limited (I need to upgrade it beyond its current 4GB of RAM)?</p>
<p>Dear Apple: APFS is a great idea, and long overdue, but it&rsquo;s kind of a mess! The lack of user data integrity checking &ndash; instead depending on the drives and their firmware to do this! &ndash; is a huge mistake. Brian Cantrill has ranted publicly about ZFS&rsquo;s checksumming (of everything) turning up all kinds of disk firmware bugs that would otherwise have led to data corruption.</p>
<p>Also, please publish better man pages, some clear manuals, security white papers, and &ldquo;best practices&rdquo; deployment notes, for APFS.</p>
<p>As I sat down to write this &ndash; I have only just finished getting my working environment set up again on this machine &ndash; I found a bug. In Vim. I had to build my own version of Vim because the version that ships with High Sierra &ndash; 8.0.something &ndash; seemed to be ignoring my <code>~/.vim/after/ftplugin/</code> files. Rather than debug this I just built a recent 8.1 and it seems to work fine. While this isn&rsquo;t Apple&rsquo;s fault <em>exactly</em>, the bug was in the version of Vim that they ship. Oh well.</p>
<hr />
<h3 id="january-30-13:57"><a href="#january-30-13:57">2019 January 30 13:57</a></h3>
<h4 id="happy-new-year"><a href="#happy-new-year">Happy New Year!</a></h4>
<p>I wish you and your loved ones all the best in 2019!</p>
<p>For my part, I&rsquo;m going to start the year off with a bit of good news for software developers, and two somewhat curious discoveries.</p>
<p>First, the good news. GitHub have recently announced that their free tier will include <a href="https://blog.github.com/2019-01-07-new-year-new-github/">unlimited private repositories, each with up to three collaborators</a>.</p>
<p>I&rsquo;ve been using GitHub for public projects and <a href="https://bitbucket.org/">Bitbucket</a> for private ones precisely because Bitbucket has for years offered the option of unlimited private repositories in their free tier. However, Bitbucket limits you to five collaborators across <em>all</em> repositories, whereas GitHub will now allow up to three collaborators for <em>each</em> repository. I like both platforms, so I doubt I&rsquo;ll move everything over, but this change should put some pressure on Bitbucket.</p>
<p>Now for the curious bits.</p>
<p>A few days ago, while down a rabbit hole related to IPv6, I discovered that broadband internet in Latvia costs a fraction of what it costs here in the USA, thanks largely to monopolies granted many years ago by the FCC.</p>
<p>I&rsquo;m paying Comcast $82 per month for 150 Mbps cable internet service. In Latvia I could get <a href="https://www.mits.lv/lv/services/tab2">100 Mbps for &euro;12 or 300 Mbps for &euro;15</a>.</p>
<p>Comcast have been &ldquo;advertising&rdquo; on NPR that they are helping families get connected to the internet. I think this claim would ring truer if decently-fast Comcast broadband cost $15/month rather than $80 or more.</p>
<p>Lastly, having decided to change my site generator to generate HTML instead of XHTML, I had to figure what was going on in the world of &ldquo;HTML5&rdquo; &ndash; which I have blissfully ignored for the past few years. I was surprised to discover that the HTML standard has actually <em>forked</em>. There are now two standards bodies &ndash; the <a href="https://www.w3.org/">W3C</a> and <a href="https://whatwg.org/">WHATWG</a> &ndash; both working on and publishing HTML standards. W3C &ndash; who had abandoned HTML in favor of XHTML and other XML-based technologies &ndash; have jumped back onto the HTML bandwagon; but whereas the WHATWG (an organization of browser vendors) want HTML to be a &ldquo;living standard&rdquo;, the W3C want it to be, as it has been in the past, a <em>versioned</em> standard.</p>
<p>The WHATWG has this to say about the difference in approaches (from the <a href="https://html.spec.whatwg.org/multipage/introduction.html#history-2">HTML spec introduction</a>):</p>
<blockquote><p>For a number of years, both groups [W3C and WHATWG] then worked together. In 2011, however, the groups came to the conclusion that they had different goals: the W3C wanted to publish a &ldquo;finished&rdquo; version of &ldquo;HTML5&rdquo;, while the WHATWG wanted to continue working on a Living Standard for HTML, continuously maintaining the specification rather than freezing it in a state with known problems, and adding new features as needed to evolve the platform.</p></blockquote>
<blockquote><p>Since then, the WHATWG has been working on this specification (amongst others), and the W3C has been copying fixes made by the WHATWG into their fork of the document (which also has other changes).</p></blockquote>
<p>You can choose to follow either standard, but since your HTML will be, in all likelihood, consumed by a web browser (or a web browser <em>engine</em> such as <a href="https://electronjs.org/">Electron</a>), the <a href="https://html.spec.whatwg.org/multipage/">WHATWG standard</a> is more likely to be accurate and useful.</p>
<p>To compare and contrast: <a href="https://www.w3.org/TR/html/">W3C&rsquo;s latest HTML standard</a> vs <a href="https://html.spec.whatwg.org/multipage/">WHATWG&rsquo;s &ldquo;living&rdquo; HTML standard</a></p>
<hr />
<p>Read the <a href="/2018/">2018 journal</a>.</p>

</div>

<div id="footer">
<hr />
<a href="mailto:%77%65%62%68%61%6d%73%74%65%72%40%6e%69%6d%62%6c%65%6d%61%63%68%69%6e%65%73%2e%63%6f%6d?subject=%5bNimble%20Machines%5d%202019%20journal">Send feedback</a> on this page (last edited 2019 September 25 14:03)<br />
Browse <a href="/all-pages/">all pages</a>, or return <a href="/">home</a>
</div>

</body>
</html>
